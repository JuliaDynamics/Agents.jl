<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer Docs · Agents.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Agents.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Agents.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Overview</a></li><li><a class="tocitem" href="../examples/schelling/">Schelling&#39;s segregation model</a></li><li><a class="tocitem" href="../examples/sugarscape/">Sugarscape</a></li><li><a class="tocitem" href="../examples/sir/">SIR model for the spread of COVID-19</a></li><li><a class="tocitem" href="../examples/social_distancing/">Continuous space social distancing for COVID-19</a></li><li><a class="tocitem" href="../examples/wealth_distribution/">Wealth distribution</a></li><li><a class="tocitem" href="../examples/forest_fire/">Forest fire</a></li><li><a class="tocitem" href="../examples/game_of_life_2D_CA/">Conway&#39;s game of life</a></li><li><a class="tocitem" href="../examples/wright-fisher/">Wright-Fisher model of evolution</a></li><li><a class="tocitem" href="../examples/hk/">Hegselmann-Krause opinion dynamics</a></li><li><a class="tocitem" href="../examples/flock/">Flocking</a></li><li><a class="tocitem" href="../examples/daisyworld/">Daisyworld</a></li><li><a class="tocitem" href="../examples/predator_prey_fast/">Predator-Prey</a></li><li><a class="tocitem" href="../examples/maze/">Maze Solver</a></li><li><a class="tocitem" href="../examples/runners/">Mountain Runners</a></li><li><a class="tocitem" href="../examples/rabbit_fox_hawk/">Rabbit, Fox, Hawk</a></li><li><a class="tocitem" href="../examples/growing_bacteria/">Bacteria Growth</a></li><li><a class="tocitem" href="../examples/opinion_spread/">Opinion spread</a></li><li><a class="tocitem" href="../examples/battle/">Battle Royale</a></li><li><a class="tocitem" href="../examples/zombies/">Zombie Outbreak</a></li><li><a class="tocitem" href="../examples/fractal_growth/">Fractal Growth</a></li></ul></li><li><a class="tocitem" href="../models/">Predefined Models</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../interact/">Plotting and interactive application</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Ecosystem Integration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/optim/">BlackBoxOptim.jl</a></li><li><a class="tocitem" href="../examples/diffeq/">DifferentialEquations.jl</a></li><li><a class="tocitem" href="../examples/schoolyard/">LightGraphs.jl</a></li><li><a class="tocitem" href="../examples/measurements/">Measurements.jl</a></li></ul></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li><li><a class="tocitem" href="../comparison/">ABM Framework Comparison</a></li><li class="is-active"><a class="tocitem" href>Developer Docs</a><ul class="internal"><li><a class="tocitem" href="#Cloning-the-repository"><span>Cloning the repository</span></a></li><li><a class="tocitem" href="#Creating-a-new-space-type"><span>Creating a new space type</span></a></li><li><a class="tocitem" href="#Designing-a-new-Pathfinder-Cost-Metric"><span>Designing a new Pathfinder Cost Metric</span></a></li><li><a class="tocitem" href="#Implementing-custom-serialization"><span>Implementing custom serialization</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Developer Docs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer Docs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Agents.jl/blob/master/docs/src/devdocs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Developer-Docs"><a class="docs-heading-anchor" href="#Developer-Docs">Developer Docs</a><a id="Developer-Docs-1"></a><a class="docs-heading-anchor-permalink" href="#Developer-Docs" title="Permalink"></a></h1><h2 id="Cloning-the-repository"><a class="docs-heading-anchor" href="#Cloning-the-repository">Cloning the repository</a><a id="Cloning-the-repository-1"></a><a class="docs-heading-anchor-permalink" href="#Cloning-the-repository" title="Permalink"></a></h2><p>Since we include documentation with many animated gifs and videos in the repository, a standard clone can be larger than expected. If you wish to do any development work, it is better to use</p><pre><code class="language-bash hljs">git clone https://github.com/JuliaDynamics/Agents.jl.git --single-branch</code></pre><h2 id="Creating-a-new-space-type"><a class="docs-heading-anchor" href="#Creating-a-new-space-type">Creating a new space type</a><a id="Creating-a-new-space-type-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-new-space-type" title="Permalink"></a></h2><p>Creating a new space type within Agents.jl is quite simple and requires the extension of only 5 methods to support the entire Agents.jl API. The exact specifications on how to create a new space type are contained within the file: <a href="https://github.com/JuliaDynamics/Agents.jl/blob/master/src/core/space_interaction_API.jl"><code>[src/core/space_interaction_API.jl]</code></a>.</p><p>In principle, the following should be done:</p><ol><li>Think about what the agent position type should be.</li><li>Think about how the space type will keep track of the agent positions, so that it is possible to implement the function <a href="../api/#Agents.nearby_ids"><code>nearby_ids</code></a>.</li><li>Implement the <code>struct</code> that represents your new space, while making it a subtype of <code>AbstractSpace</code>.</li><li>Extend <code>random_position(model)</code>.</li><li>Think about how the positions of agents will be updated as agents are moved, added or killed.</li><li>Extend <code>move_agent!(agent, pos, model), add_agent_to_space!(agent, model), remove_agent_from_space!(agent, model)</code>.</li><li>Extend <code>nearby_ids(position, model, r)</code>.</li></ol><p>And that&#39;s it!</p><h2 id="Designing-a-new-Pathfinder-Cost-Metric"><a class="docs-heading-anchor" href="#Designing-a-new-Pathfinder-Cost-Metric">Designing a new Pathfinder Cost Metric</a><a id="Designing-a-new-Pathfinder-Cost-Metric-1"></a><a class="docs-heading-anchor-permalink" href="#Designing-a-new-Pathfinder-Cost-Metric" title="Permalink"></a></h2><p>To define a new cost metric, simply make a struct that subtypes <code>CostMetric</code> and provide a <code>delta_cost</code> function for it. These methods work solely for A* at present, but will be available for other pathfinder algorithms in the future.</p><article class="docstring"><header><a class="docstring-binding" id="Agents.Pathfinding.CostMetric" href="#Agents.Pathfinding.CostMetric"><code>Agents.Pathfinding.CostMetric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Pathfinding.CostMetric{D}</code></pre><p>An abstract type representing a metric that measures the approximate cost of travelling between two points in a <code>D</code> dimensional grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/32fc77efad6d38130c6450a994db80a71749073d/src/submodules/pathfinding/metrics.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Agents.Pathfinding.delta_cost" href="#Agents.Pathfinding.delta_cost"><code>Agents.Pathfinding.delta_cost</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Pathfinding.delta_cost(pathfinder::GridPathfinder{D}, metric::M, from, to) where {M&lt;:CostMetric}</code></pre><p>Calculate an approximation for the cost of travelling from <code>from</code> to <code>to</code> (both of type <code>NTuple{N,Int}</code>. Expects a return value of <code>Float64</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/32fc77efad6d38130c6450a994db80a71749073d/src/submodules/pathfinding/pathfinding_utils.jl#L12-L16">source</a></section></article><h2 id="Implementing-custom-serialization"><a class="docs-heading-anchor" href="#Implementing-custom-serialization">Implementing custom serialization</a><a id="Implementing-custom-serialization-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-custom-serialization" title="Permalink"></a></h2><h3 id="For-model-properties"><a class="docs-heading-anchor" href="#For-model-properties">For model properties</a><a id="For-model-properties-1"></a><a class="docs-heading-anchor-permalink" href="#For-model-properties" title="Permalink"></a></h3><p>Custom serialization may be required if your properties contain non-serializable data, such as functions. Alternatively, if it is possible to recalculate some properties during deserialization it may be space-efficient to not save them. To implement custom serialization, define methods for the <code>to_serializable</code> and <code>from_serializable</code> functions:</p><article class="docstring"><header><a class="docstring-binding" id="Agents.AgentsIO.to_serializable" href="#Agents.AgentsIO.to_serializable"><code>Agents.AgentsIO.to_serializable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AgentsIO.to_serializable(t)</code></pre><p>Return the serializable form of the passed value. This defaults to the value itself, unless a more specific method is defined. Define a method for this function and for <a href="#Agents.AgentsIO.from_serializable"><code>AgentsIO.from_serializable</code></a> if you need custom serialization for model properties. This also enables passing keyword arguments to <a href="../api/#Agents.AgentsIO.load_checkpoint"><code>AgentsIO.load_checkpoint</code></a> and having access to them during deserialization of the properties. Some possible scenarios where this may be required are:</p><ul><li>Your properties contain functions (or any type not supported by JLD2.jl). These may not be (de)serialized correctly. This could result in checkpoint files that cannot be loaded back in, or contain reconstructed types that do not retain their data/functionality.</li><li>Your properties contain data that can be recalculated during deserialization. Omitting such properties can reduce the size of the checkpoint file, at the expense of some extra computation at deserialization.</li></ul><p>If your model properties do not fall in the above scenarios, you do not need to use this function.</p><p>This function is not called recursively on every type/value during serialization. The final serialization functionality is enabled by JLD2.jl. To define custom serialization for every occurence of a specific type (such as agent structs), refer to the Custom Serialization section of JLD2.jl documentation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/32fc77efad6d38130c6450a994db80a71749073d/src/submodules/io/jld2_integration.jl#L4-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Agents.AgentsIO.from_serializable" href="#Agents.AgentsIO.from_serializable"><code>Agents.AgentsIO.from_serializable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AgentsIO.from_serializable(t; kwargs...)</code></pre><p>Given a value in its serializable form, return the original version. This defaults to the value itself, unless a more specific method is defined. Define a method for  this function and for <a href="#Agents.AgentsIO.to_serializable"><code>AgentsIO.to_serializable</code></a> if you need custom serialization for model properties. This also enables passing keyword arguments to <a href="../api/#Agents.AgentsIO.load_checkpoint"><code>AgentsIO.load_checkpoint</code></a> and having access to them through <code>kwargs</code>.</p><p>Refer to <a href="#Agents.AgentsIO.to_serializable"><code>AgentsIO.to_serializable</code></a> to check when you need to define this function.</p><p>This function is not called recursively on every type/value during deserialization. The final serialization functionality is enabled by JLD2.jl. To define custom serialization for every occurence of a specific type (such as agent structs), refer to the Custom Serialization section of JLD2.jl documentation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/32fc77efad6d38130c6450a994db80a71749073d/src/submodules/io/jld2_integration.jl#L31-L46">source</a></section></article><h3 id="For-agent-structs"><a class="docs-heading-anchor" href="#For-agent-structs">For agent structs</a><a id="For-agent-structs-1"></a><a class="docs-heading-anchor-permalink" href="#For-agent-structs" title="Permalink"></a></h3><p>Similarly to model properties, you may need to implement custom serialization for agent structs. <code>from_serializable</code> and <code>to_serializable</code> are not called during (de)serialization of agent structs. Instead, <a href="https://juliaio.github.io/JLD2.jl/stable/customserialization/">JLD2&#39;s custom serialization functionality</a> should be used. All instances of the agent struct will be converted to and from the specified type during serialization. For OpenStreetMap agents, the position, destination and route are saved separately. These values will be loaded back in during deserialization of the model and override any values in the agent structs. To save space, the agents in the serialized model will have empty <code>route</code> fields.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../comparison/">« ABM Framework Comparison</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Tuesday 7 December 2021 20:12">Tuesday 7 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
