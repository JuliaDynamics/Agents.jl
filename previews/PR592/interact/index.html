<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting and interactive application · Agents.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Agents.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Agents.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/schelling/">Schelling&#39;s segregation model</a></li><li><a class="tocitem" href="../examples/sir/">SIR model for the spread of COVID-19</a></li><li><a class="tocitem" href="../examples/flock/">Flocking</a></li><li><a class="tocitem" href="../examples/zombies/">Zombie Outbreak</a></li><li><a class="tocitem" href="../examples/rabbit_fox_hawk/">Rabbit, Fox, Hawk</a></li><li><a class="tocitem" href="../models/">Predefined Models</a></li><li><a class="tocitem" href="../examples/">More Examples for Agents.jl</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li class="is-active"><a class="tocitem" href>Plotting and interactive application</a><ul class="internal"><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Interactive-application"><span>Interactive application</span></a></li><li><a class="tocitem" href="#Graph-plotting"><span>Graph plotting</span></a></li><li><a class="tocitem" href="#Open-Street-Map-plotting"><span>Open Street Map plotting</span></a></li><li><a class="tocitem" href="#Plots.jl-Recipes"><span>Plots.jl Recipes</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Ecosystem Integration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/optim/">BlackBoxOptim.jl</a></li><li><a class="tocitem" href="../examples/diffeq/">DifferentialEquations.jl</a></li><li><a class="tocitem" href="../examples/schoolyard/">Graphs.jl</a></li><li><a class="tocitem" href="../examples/measurements/">Measurements.jl</a></li></ul></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li><li><a class="tocitem" href="../comparison/">ABM Framework Comparison</a></li><li><a class="tocitem" href="../devdocs/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Plotting and interactive application</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting and interactive application</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Agents.jl/blob/master/docs/src/interact.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Plotting-and-interactive-application"><a class="docs-heading-anchor" href="#Plotting-and-interactive-application">Plotting and interactive application</a><a id="Plotting-and-interactive-application-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-and-interactive-application" title="Permalink"></a></h1><p>Plotting and interaction functionality comes from <a href="https://juliadynamics.github.io/InteractiveDynamics.jl/dev/"><code>InteractiveDynamics</code></a>, another package of JuliaDynamics, which uses Makie.jl.</p><p>Plotting, and the interactive application of Agents.jl, are <em>model-agnostic</em> and <em>simple to use</em>. Defining simple functions that map agents to colors, and shapes, is the only thing you need to do. If you have already defined an ABM and functions for stepping the model, you typically need to write only an extra couple of lines of code to get your visualizations going. All models in the Examples showcase plotting.</p><p>You need to install both <code>InteractiveDynamics</code>, as well as a plotting backend (we recommend <code>GLMakie</code>) to use the following functions.</p><p>The version of <code>InteractiveDynamics</code> used in the docs is:</p><pre><code class="language-julia hljs">using Pkg
Pkg.status(&quot;InteractiveDynamics&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">      Status `~/work/Agents.jl/Agents.jl/docs/Project.toml`
  [ec714cd0] InteractiveDynamics v0.18.1</code></pre><p>Some parts of Agents.jl cannot be plotted yet in Makie.jl, and therefore alternatives are provided. However in the near future we hope to have moved everything to plotting with Makie.jl and not necessitate usage of Plots.jl or other libraries.</p><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>The following functions allow you to plot an ABM, animate it via play/pause buttons, or directly export the time evolution into a video. At the moment these functions support 2D continuous and discrete space.</p><article class="docstring"><header><a class="docstring-binding" id="InteractiveDynamics.abm_plot" href="#InteractiveDynamics.abm_plot"><code>InteractiveDynamics.abm_plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abm_plot(model::ABM; kwargs...) → fig, abmstepper</code></pre><p>Plot an agent based model by plotting each individual agent as a marker and using the agent&#39;s position field as its location on the plot. Requires <code>Agents</code>.</p><p>Return the overarching <code>fig</code> object, as well as a struct <code>abmstepper</code> that can be used to interactively animate the evolution of the ABM and combine it with other subplots. The figure is not displayed by default, you need to either return <code>fig</code> as a last statement in your functions or simply call <code>display(fig)</code>. Notice that models with <code>DiscreteSpace</code> are plotted starting from 0 to n, with n the space size along each dimension.</p><p>To progress the ABM plot <code>n</code> steps simply do:</p><pre><code class="language-julia hljs">Agents.step!(abmstepper, model, agent_step!, model_step!, n)</code></pre><p>You can still call this function with <code>n=0</code> to update the plot for a new <code>model</code>, without doing any stepping. From <code>fig</code> you can obtain the plotted axis (to e.g. turn off ticks, etc.) using <code>ax = content(fig[1, 1])</code>. See <a href="@ref">Sugarscape</a> for an example of using <code>abmstepper</code> to make an animation of evolving the ABM and a heatmap in parallel with only a few lines of code.</p><p><strong>Agent related keywords</strong></p><ul><li><p><code>ac, as, am</code>: These three keywords decided the color, size, and marker, that each agent will be plotted as. They can each be either a constant or a <em>function</em>, which takes as an input a single argument and ouputs the corresponding value. For example:</p><pre><code class="language-julia hljs"># ac = &quot;#338c54&quot;
ac(a) = a.status == :S ? &quot;#2b2b33&quot; : a.status == :I ? &quot;#bf2642&quot; : &quot;#338c54&quot;
# as = 10
as(a) = 10*randn() + 1
# am = :diamond
am(a) = a.status == :S ? :circle : a.status == :I ? :diamond : :rect</code></pre><p>Notice that for 2D models, <code>am</code> can be/return a <code>Polygon</code> instance, which plots each agent as an arbitrary polygon. It is assumed that the origin (0, 0) is the agent&#39;s position when creating the polygon. In this case, the keyword <code>as</code> is meaningless, as each polygon has its own size. Use the functions <code>scale, rotate2D</code> to transform this polygon.</p><p>3D models currently do not support having different markers. As a result, <code>am</code> cannot be a function. It should be a <code>Mesh</code> or 3D primitive (such as <code>Sphere</code> or <code>Rect3D</code>).</p></li><li><p><code>scheduler = model.scheduler</code>: decides the plotting order of agents (which matters only if there is overlap).</p></li><li><p><code>offset = nothing</code>: If not <code>nothing</code>, it must be a function taking as an input an agent and outputting an offset position vector to be added to the agent&#39;s position (which matters only if there is overlap).</p></li><li><p><code>scatterkwargs = ()</code>: Additional keyword arguments propagated to the resulting ABMPlot.</p></li></ul><p><strong>Figure related keywords</strong></p><ul><li><code>resolution = (600, 600)</code>: Resolution of the figure.</li><li><code>colorscheme = JULIADYNAMICS_COLORS</code>: Vector of colors which is used as default colorscheme in the figure.</li><li><code>backgroundcolor = DEFAULT_BG</code>: Background color of the figure.</li><li><code>axiskwargs = NamedTuple()</code>: Keyword arguments given to the main axis creation for e.g. setting <code>xticksvisible = false</code>.</li><li><code>aspect = DataAspect()</code>: The aspect ratio behavior of the axis.</li></ul><p><strong>Preplot related keywords</strong></p><ul><li><code>heatarray = nothing</code> : A keyword that plots a heatmap over the space. Its values can be standard data accessors given to functions like <code>run!</code>, i.e. either a symbol (directly obtain model property) or a function of the model. The returned data must be a matrix of the same size as the underlying space. For example <code>heatarray = :temperature</code> is used in the <a href="@ref">Daisyworld</a> example. But you could also define <code>f(model) = create_some_matrix_from_model...</code> and set <code>heatarray = f</code>. The heatmap will be updated automatically during model evolution in videos and interactive applications.</li><li><code>heatkwargs = NamedTuple()</code> : Keywords given to <code>Makie.heatmap</code> function if <code>heatarray</code> is not nothing.</li><li><code>static_preplot!</code> : A function <code>f(ax, model)</code> that plots something after the heatmap but before the agents. Notice that you can still make objects of this plot be visible above the agents using a translation in the third dimension like below:<pre><code class="language-julia hljs">function static_preplot!(ax, model)
    obj = CairoMakie.scatter!([50 50]; color = :red) # Show position of teacher
    CairoMakie.hidedecorations!(ax) # hide tick labels etc.
    CairoMakie.translate!(obj, 0, 0, 5) # be sure that the teacher will be above students
end</code></pre></li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="InteractiveDynamics.abm_play" href="#InteractiveDynamics.abm_play"><code>InteractiveDynamics.abm_play</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abm_play(model, agent_step! [, model_step!]; kwargs...) → fig, abmstepper</code></pre><p>Launch an interactive application that plots an agent based model and can animate its evolution in real time. Requires <code>Agents</code>.</p><p>The agents are plotted exactly like in <a href="#InteractiveDynamics.abm_plot"><code>abm_plot</code></a>, while the two functions <code>agent_step!, model_step!</code> decide how the model will evolve, as in the standard approach of Agents.jl and its <code>step!</code> function.</p><p>The application has three buttons:</p><ul><li>&quot;step&quot;: advances the simulation once for <code>spu</code> steps.</li><li>&quot;run&quot;: starts/stops the continuous evolution of the model.</li><li>&quot;reset&quot;: resets the model to its original configuration. </li></ul><p>Two sliders control the animation speed: &quot;spu&quot; decides how many model steps should be done before the plot is updated, and &quot;sleep&quot; the <code>sleep()</code> time between updates.</p><p><strong>Keywords</strong></p><ul><li><code>ac, am, as, scheduler, offset, aspect, scatterkwargs</code>: propagated to <a href="#InteractiveDynamics.abm_plot"><code>abm_plot</code></a>.</li><li><code>spu = 1:100</code>: The values of the &quot;spu&quot; slider.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="InteractiveDynamics.abm_video" href="#InteractiveDynamics.abm_video"><code>InteractiveDynamics.abm_video</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abm_video(file, model, agent_step! [, model_step!]; kwargs...)</code></pre><p>This function exports the animated time evolution of an agent based model into a video saved at given path <code>file</code>, by recording the behavior of <a href="#InteractiveDynamics.abm_play"><code>abm_play</code></a> (without sliders). The plotting is identical as in <a href="#InteractiveDynamics.abm_plot"><code>abm_plot</code></a> and applicable keywords are propagated.</p><p><strong>Keywords</strong></p><ul><li><code>spf = 1</code>: Steps-per-frame, i.e. how many times to step the model before recording a new frame.</li><li><code>framerate = 30</code>: The frame rate of the exported video.</li><li><code>frames = 300</code>: How many frames to record in total, including the starting frame.</li><li><code>title = &quot;&quot;</code>: The title of the figure.</li><li><code>showstep = true</code>: If current step should be shown in title.</li><li><code>kwargs...</code>: All other keywords are propagated to <a href="#InteractiveDynamics.abm_plot"><code>abm_plot</code></a>.</li></ul></div></section></article><h2 id="Interactive-application"><a class="docs-heading-anchor" href="#Interactive-application">Interactive application</a><a id="Interactive-application-1"></a><a class="docs-heading-anchor-permalink" href="#Interactive-application" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="InteractiveDynamics.abm_data_exploration" href="#InteractiveDynamics.abm_data_exploration"><code>InteractiveDynamics.abm_data_exploration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abm_data_exploration(model::ABM, agent_step!, model_step!, params=Dict(); kwargs...)</code></pre><p>Open an interactive application for exploring an agent based model and the impact of changing parameters on the time evolution. Requires <code>Agents</code>.</p><p>The application evolves an ABM interactively and plots its evolution, while allowing changing any of the model parameters interactively and also showing the evolution of collected data over time (if any are asked for, see below). The agent based model is plotted and animated exactly as in <a href="#InteractiveDynamics.abm_play"><code>abm_play</code></a>, and the arguments <code>model, agent_step!, model_step!</code> are propagated there as-is.</p><p>Calling <code>abm_data_exploration</code> returns: <code>fig, agent_df, model_df</code>. So you can save the figure, but you can also access the collected data (if any).</p><p><strong>Interaction</strong></p><p>Besides the basic time evolution interaction of <a href="#InteractiveDynamics.abm_play"><code>abm_play</code></a>, additional functionality here allows changing model parameters in real time, based on the provided fourth argument <code>params</code>. This is a dictionary which decides which parameters of the model will be configurable from the interactive application. Each entry of <code>params</code> is a pair of <code>Symbol</code> to an <code>AbstractVector</code>, and provides a range of possible values for the parameter named after the given symbol (see example online). Changing a value in the parameter slides is only updated into the actual model when pressing the &quot;update&quot; button.</p><p>The &quot;reset&quot; button resets the model to its original agent and space state but it updates it to the currently selected parameter values. A red vertical line is displayed in the data plots when resetting, for visual guidance.</p><p><strong>Keywords</strong></p><ul><li><code>ac, am, as, scheduler, offset, aspect, scatterkwargs</code>: propagated to <a href="#InteractiveDynamics.abm_plot"><code>abm_plot</code></a>.</li><li><code>adata, mdata</code>: Same as the keyword arguments of <code>Agents.run!</code>, and decide which data of the model/agents will be collected and plotted below the interactive plot. Notice that data collection can only occur on plotted steps (and thus steps not plotted due to &quot;spu&quot; are also not data-collected).</li><li><code>alabels, mlabels</code>: If data are collected from agents or the model with <code>adata, mdata</code>, the corresponding plots have a y-label named after the collected data. Instead, you can give <code>alabels, mlabels</code> (vectors of strings with exactly same length as <code>adata, mdata</code>), and these labels will be used instead.</li><li><code>when = true</code>: When to perform data collection, as in <code>Agents.run!</code>.</li><li><code>spu = 1:100</code>: Values that the &quot;spu&quot; slider will obtain.</li></ul></div></section></article><p>Here is an example application made with <a href="#InteractiveDynamics.abm_data_exploration"><code>InteractiveDynamics.abm_data_exploration</code></a> from the <a href="@ref">Daisyworld</a> example.</p><h2 id="Graph-plotting"><a class="docs-heading-anchor" href="#Graph-plotting">Graph plotting</a><a id="Graph-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-plotting" title="Permalink"></a></h2><p>To plot agents existing of a <a href="../api/#Agents.GraphSpace"><code>GraphSpace</code></a> we can&#39;t use <code>InteractiveDynamics</code> because Makie.jl does not support plotting on graphs (yet). We provide the following function in this case, which comes into scope when <code>using Plots</code>. See also the <a href="../examples/sir/#SIR-model-for-the-spread-of-COVID-19">SIR model for the spread of COVID-19</a> example for an application.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>abm_plot_on_graph</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Open-Street-Map-plotting"><a class="docs-heading-anchor" href="#Open-Street-Map-plotting">Open Street Map plotting</a><a id="Open-Street-Map-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Open-Street-Map-plotting" title="Permalink"></a></h2><p>Plotting an open street map is also not possible with Makie.jl at the moment, but there is a Julia package that does this kind of plotting, OpenStreetMapXPlots.jl. Its usage is demonstrated in the <a href="../examples/zombies/#Zombie-Outbreak">Zombie Outbreak</a> example page.</p><h2 id="Plots.jl-Recipes"><a class="docs-heading-anchor" href="#Plots.jl-Recipes">Plots.jl Recipes</a><a id="Plots.jl-Recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Plots.jl-Recipes" title="Permalink"></a></h2><p>Whilst the primary method for plotting agents models is through <code>InteractiveDynamics</code>, the following Plots recipes can also be used if you prefer the Plots.jl ecosystem.</p><p>Notice that these methods will emit a warning. Pass <code>warn = false</code> to suppress it.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>plotabm</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>plotabm!</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API</a><a class="docs-footer-nextpage" href="../examples/optim/">BlackBoxOptim.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Sunday 23 January 2022 10:11">Sunday 23 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
