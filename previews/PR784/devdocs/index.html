<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer Docs · Agents.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Agents.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Agents.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/schelling/">Schelling&#39;s segregation model</a></li><li><a class="tocitem" href="../examples/sir/">SIR model for the spread of COVID-19</a></li><li><a class="tocitem" href="../examples/flock/">Flocking model</a></li><li><a class="tocitem" href="../examples/zombies/">Zombie Outbreak in a City</a></li><li><a class="tocitem" href="../examples/predator_prey/">Predator-prey dynamics</a></li><li><a class="tocitem" href="../examples/rabbit_fox_hawk/">3D Mixed-Agent Ecosystem with Pathfinding</a></li><li><a class="tocitem" href="../models/">Predefined Models</a></li><li><a class="tocitem" href="../examples/">More Examples for Agents.jl</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../agents_visualizations/">Plotting and Interactivity</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Ecosystem Integration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/optim/">BlackBoxOptim.jl</a></li><li><a class="tocitem" href="../examples/diffeq/">DifferentialEquations.jl</a></li><li><a class="tocitem" href="../examples/schoolyard/">Graphs.jl</a></li><li><a class="tocitem" href="../examples/measurements/">Measurements.jl</a></li><li><a class="tocitem" href="../examples/celllistmap/">CellListMap.jl</a></li></ul></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li><li><a class="tocitem" href="../comparison/">ABM Framework Comparison</a></li><li class="is-active"><a class="tocitem" href>Developer Docs</a><ul class="internal"><li><a class="tocitem" href="#Cloning-the-repository-1"><span>Cloning the repository</span></a></li><li><a class="tocitem" href="#Creating-a-new-space-type-1"><span>Creating a new space type</span></a></li><li><a class="tocitem" href="#Designing-a-new-Pathfinder-Cost-Metric-1"><span>Designing a new Pathfinder Cost Metric</span></a></li><li><a class="tocitem" href="#Implementing-custom-serialization-1"><span>Implementing custom serialization</span></a></li><li><a class="tocitem" href="#OpenStreetMapSpace-internals-1"><span>OpenStreetMapSpace internals</span></a></li><li><a class="tocitem" href="#Benchmarking-1"><span>Benchmarking</span></a></li><li><a class="tocitem" href="#Creating-a-new-AgentBasedModel-implementation-1"><span>Creating a new <code>AgentBasedModel</code> implementation</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Developer Docs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer Docs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Agents.jl/blob/master/docs/src/devdocs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Developer-Docs-1"><a class="docs-heading-anchor" href="#Developer-Docs-1">Developer Docs</a><a class="docs-heading-anchor-permalink" href="#Developer-Docs-1" title="Permalink"></a></h1><h2 id="Cloning-the-repository-1"><a class="docs-heading-anchor" href="#Cloning-the-repository-1">Cloning the repository</a><a class="docs-heading-anchor-permalink" href="#Cloning-the-repository-1" title="Permalink"></a></h2><p>Since we include documentation with many animated gifs and videos in the repository, a standard clone can be larger than expected. If you wish to do any development work, it is better to use</p><pre><code class="language-bash">git clone https://github.com/JuliaDynamics/Agents.jl.git --single-branch</code></pre><h2 id="Creating-a-new-space-type-1"><a class="docs-heading-anchor" href="#Creating-a-new-space-type-1">Creating a new space type</a><a class="docs-heading-anchor-permalink" href="#Creating-a-new-space-type-1" title="Permalink"></a></h2><p>Creating a new space type within Agents.jl is quite simple and requires the extension of only 5 methods to support the entire Agents.jl API. The exact specifications on how to create a new space type are contained within the source file: <a href="https://github.com/JuliaDynamics/Agents.jl/blob/main/src/core/space_interaction_API.jl"><code>src/core/space_interaction_API.jl</code></a>.</p><p>In principle, the following should be done:</p><ol><li>Think about what the agent position type should be. Add this type to the <code>ValidPos</code> union type in <code>src/core/model_abstract.jl</code>.</li><li>Think about how the space type will keep track of the agent positions, so that it is possible to implement the function <a href="../api/#Agents.nearby_ids"><code>nearby_ids</code></a>.</li><li>Implement the <code>struct</code> that represents your new space, while making it a subtype of <code>AbstractSpace</code>.</li><li>Extend <code>random_position(model)</code>.</li><li>Extend <code>add_agent_to_space!(agent, model), remove_agent_from_space!(agent, model)</code>. This already provides access to <code>add_agent!, kill_agent!</code> and <code>move_agent!</code>.</li><li>Extend <code>nearby_ids(position, model, r)</code>.</li><li>Create a new &quot;minimal&quot; agent type to be used with <a href="../tutorial/#Agents.@agent"><code>@agent</code></a> (see the source code of <a href="../api/#Agents.GraphAgent"><code>GraphAgent</code></a> for an example).</li></ol><p>And that&#39;s it! Every function of the main API will now work. In some situations you might want to explicitly extend other functions such as <code>move_agent!</code> for performance reasons.</p><h2 id="Designing-a-new-Pathfinder-Cost-Metric-1"><a class="docs-heading-anchor" href="#Designing-a-new-Pathfinder-Cost-Metric-1">Designing a new Pathfinder Cost Metric</a><a class="docs-heading-anchor-permalink" href="#Designing-a-new-Pathfinder-Cost-Metric-1" title="Permalink"></a></h2><p>To define a new cost metric, simply make a struct that subtypes <code>CostMetric</code> and provide a <code>delta_cost</code> function for it. These methods work solely for A* at present, but will be available for other pathfinder algorithms in the future.</p><article class="docstring"><header><a class="docstring-binding" id="Agents.Pathfinding.CostMetric" href="#Agents.Pathfinding.CostMetric"><code>Agents.Pathfinding.CostMetric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Pathfinding.CostMetric{D}</code></pre><p>An abstract type representing a metric that measures the approximate cost of travelling between two points in a <code>D</code> dimensional grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/c74e7ecb7710bfc67b42f24fb30fce2f0e907429/src/submodules/pathfinding/metrics.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Agents.Pathfinding.delta_cost" href="#Agents.Pathfinding.delta_cost"><code>Agents.Pathfinding.delta_cost</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Pathfinding.delta_cost(pathfinder::GridPathfinder{D}, metric::M, from, to) where {M&lt;:CostMetric}</code></pre><p>Calculate an approximation for the cost of travelling from <code>from</code> to <code>to</code> (both of type <code>NTuple{N,Int}</code>. Expects a return value of <code>Float64</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/c74e7ecb7710bfc67b42f24fb30fce2f0e907429/src/submodules/pathfinding/pathfinding_utils.jl#L12-L16">source</a></section></article><h2 id="Implementing-custom-serialization-1"><a class="docs-heading-anchor" href="#Implementing-custom-serialization-1">Implementing custom serialization</a><a class="docs-heading-anchor-permalink" href="#Implementing-custom-serialization-1" title="Permalink"></a></h2><h3 id="For-model-properties-1"><a class="docs-heading-anchor" href="#For-model-properties-1">For model properties</a><a class="docs-heading-anchor-permalink" href="#For-model-properties-1" title="Permalink"></a></h3><p>Custom serialization may be required if your properties contain non-serializable data, such as functions. Alternatively, if it is possible to recalculate some properties during deserialization it may be space-efficient to not save them. To implement custom serialization, define methods for the <code>to_serializable</code> and <code>from_serializable</code> functions:</p><article class="docstring"><header><a class="docstring-binding" id="Agents.AgentsIO.to_serializable" href="#Agents.AgentsIO.to_serializable"><code>Agents.AgentsIO.to_serializable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">AgentsIO.to_serializable(t)</code></pre><p>Return the serializable form of the passed value. This defaults to the value itself, unless a more specific method is defined. Define a method for this function and for <a href="#Agents.AgentsIO.from_serializable"><code>AgentsIO.from_serializable</code></a> if you need custom serialization for model properties. This also enables passing keyword arguments to <a href="../api/#Agents.AgentsIO.load_checkpoint"><code>AgentsIO.load_checkpoint</code></a> and having access to them during deserialization of the properties. Some possible scenarios where this may be required are:</p><ul><li>Your properties contain functions (or any type not supported by JLD2.jl). These may not be (de)serialized correctly. This could result in checkpoint files that cannot be loaded back in, or contain reconstructed types that do not retain their data/functionality.</li><li>Your properties contain data that can be recalculated during deserialization. Omitting such properties can reduce the size of the checkpoint file, at the expense of some extra computation at deserialization.</li></ul><p>If your model properties do not fall in the above scenarios, you do not need to use this function.</p><p>This function, and <a href="#Agents.AgentsIO.from_serializable"><code>AgentsIO.from_serializable</code></a> is not called recursively on every type/value during serialization. The final serialization functionality is enabled by JLD2.jl. To define custom serialization for every occurence of a specific type (such as agent structs), refer to the Custom Serialization section of JLD2.jl documentation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/c74e7ecb7710bfc67b42f24fb30fce2f0e907429/src/submodules/io/jld2_integration.jl#L4-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Agents.AgentsIO.from_serializable" href="#Agents.AgentsIO.from_serializable"><code>Agents.AgentsIO.from_serializable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">AgentsIO.from_serializable(t; kwargs...)</code></pre><p>Given a value in its serializable form, return the original version. This defaults to the value itself, unless a more specific method is defined. Define a method for this function and for <a href="#Agents.AgentsIO.to_serializable"><code>AgentsIO.to_serializable</code></a> if you need custom serialization for model properties. This also enables passing keyword arguments to <a href="../api/#Agents.AgentsIO.load_checkpoint"><code>AgentsIO.load_checkpoint</code></a> and having access to them through <code>kwargs</code>.</p><p>Refer to <a href="#Agents.AgentsIO.to_serializable"><code>AgentsIO.to_serializable</code></a> for more info.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/Agents.jl/blob/c74e7ecb7710bfc67b42f24fb30fce2f0e907429/src/submodules/io/jld2_integration.jl#L32-L42">source</a></section></article><h3 id="For-agent-structs-1"><a class="docs-heading-anchor" href="#For-agent-structs-1">For agent structs</a><a class="docs-heading-anchor-permalink" href="#For-agent-structs-1" title="Permalink"></a></h3><p>Similarly to model properties, you may need to implement custom serialization for agent structs. <code>from_serializable</code> and <code>to_serializable</code> are not called during (de)serialization of agent structs. Instead, <a href="https://juliaio.github.io/JLD2.jl/stable/customserialization/">JLD2&#39;s custom serialization functionality</a> should be used. All instances of the agent struct will be converted to and from the specified type during serialization. For OpenStreetMap agents, the position, destination and route are saved separately. These values will be loaded back in during deserialization of the model and override any values in the agent structs. To save space, the agents in the serialized model will have empty <code>route</code> fields.</p><h2 id="OpenStreetMapSpace-internals-1"><a class="docs-heading-anchor" href="#OpenStreetMapSpace-internals-1">OpenStreetMapSpace internals</a><a class="docs-heading-anchor-permalink" href="#OpenStreetMapSpace-internals-1" title="Permalink"></a></h2><p>Details about the internal details of the OSMSpace are discussed in the docstring of <code>OSM.OpenStreetMapPath</code>.</p><h2 id="Benchmarking-1"><a class="docs-heading-anchor" href="#Benchmarking-1">Benchmarking</a><a class="docs-heading-anchor-permalink" href="#Benchmarking-1" title="Permalink"></a></h2><p>As Agents.jl is developed we want to monitor code efficiency through <em>benchmarks</em>. A benchmark is a function or other bit of code whose execution is timed so that developers and users can keep track of how long different API functions take when used in various ways. Individual benchmarks can be organized into <em>suites</em> of benchmark tests. See the <a href="https://github.com/JuliaDynamics/Agents.jl/tree/main/benchmark"><code>benchmark</code></a> directory to view Agents.jl&#39;s benchmark suites. Follow these examples to add your own benchmarks for your Agents.jl contributions. See the BenchmarkTools <a href="https://github.com/JuliaCI/BenchmarkTools.jl#quick-start">quickstart guide</a>, <a href="https://github.com/JuliaCI/BenchmarkTools.jl/blob/master/benchmark/benchmarks.jl">toy example benchmark suite</a>, and the <a href="https://juliaci.github.io/BenchmarkTools.jl/dev/manual/#Benchmarking-basics">BenchmarkTools.jl manual</a> for more information on how to write your own benchmarks.</p><h2 id="Creating-a-new-AgentBasedModel-implementation-1"><a class="docs-heading-anchor" href="#Creating-a-new-AgentBasedModel-implementation-1">Creating a new <code>AgentBasedModel</code> implementation</a><a class="docs-heading-anchor-permalink" href="#Creating-a-new-AgentBasedModel-implementation-1" title="Permalink"></a></h2><p>The interface defined by <code>AgentBasedModel</code>, that needs to be satisfied by new implementations, is very small. It is contained in the file <code>src/core/model_abstract.jl</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../comparison/">« ABM Framework Comparison</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 22 March 2023 23:20">Wednesday 22 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
